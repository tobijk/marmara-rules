Origin: http://cvs.openssl.org/chngview?cn=21940
Subject: Clear bytes used for block padding of SSL 3.0 records.

CVE-2011-4576

[Ubuntu note: modification to CHANGES file has been dropped to reduce
 patch conflicts.]

---
 ssl/s3_enc.c |    3 +++
 1 file changed, 3 insertions(+)

Index: b/ssl/s3_enc.c
===================================================================
--- a/ssl/s3_enc.c
+++ b/ssl/s3_enc.c
@@ -480,6 +480,9 @@ int ssl3_enc(SSL *s, int send)
 
 			/* we need to add 'i-1' padding bytes */
 			l+=i;
+			/* the last of these zero bytes will be overwritten
+			 * with the padding length. */
+			memset(&rec->input[rec->length], 0, i);
 			rec->length+=i;
 			rec->input[l-1]=(i-1);
 			}
